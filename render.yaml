# Render.com deployment configuration
# This file helps you quickly deploy your Laravel API to Render.com
# 
# Instructions:
# 1. Sign up at https://render.com
# 2. Connect your GitHub account
# 3. Select "New Web Service"
# 4. Connect your repository: Clopes1997/productmanager
# 5. Render will automatically detect this file
# 6. Add your environment variables (see below)
# 7. Deploy!

services:
  - type: web
    name: productmanager-api
    env: php
    region: oregon
    plan: free
    buildCommand: composer install --no-dev --optimize-autoloader && mkdir -p database && touch database/database.sqlite
    startCommand: mkdir -p database && touch database/database.sqlite && chmod 664 database/database.sqlite && php artisan migrate --force && php artisan config:clear && php artisan serve --host=0.0.0.0 --port=$PORT
    healthCheckPath: /api/produtos
    envVars:
      - key: APP_ENV
        value: production
      - key: APP_DEBUG
        value: true
      - key: APP_URL
        fromService:
          type: web
          name: productmanager-api
          property: host
      # Database - using SQLite for simplicity (free tier)
      - key: DB_CONNECTION
        value: sqlite
      # DB_DATABASE not set - Laravel will use database_path('database.sqlite') which resolves correctly
      # Session and Cache
      - key: SESSION_DRIVER
        value: database
      - key: CACHE_STORE
        value: database
      - key: QUEUE_CONNECTION
        value: database
      # Add these manually in Render dashboard (optional):
      # - APP_KEY (will be auto-generated if not set, format: base64:...)
      # - APP_NAME (optional, defaults to "Laravel")
      # - LOG_LEVEL (optional, defaults to "error")

